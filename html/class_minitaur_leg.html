<!-- HTML header for doxygen 1.8.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>Koduino: MinitaurLeg Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
 <!-- ADDED THIS CELL -->
  <!--td style="font: 300 16px Lato,sans-serif;background-color: #eeeeee;padding: 10px;border-right:2px solid #ddd;">
  <a href="/" style="color:#444444">&#8679; avikde.me</a>
  </td-->
  <td style="padding-left: 0.5em;">
   <div id="projectname">Koduino
   </div>
   <div id="projectbrief">Arduino core for STM32</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">MinitaurLeg Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This class is derived from <a class="el" href="class_abstract_motor.html">AbstractMotor</a>, in particular it coordinates two motors together in a parallel five-bar configuration.</p>
<h3>Kinematics</h3>
<p>The kinematics of the leg can be found in <a href="http://kodlab.seas.upenn.edu/Gavin/IROS15">http://kodlab.seas.upenn.edu/Gavin/IROS15</a>. In particular, Fig. 1 (borrowed from the paper and included below) will be helpful to follow this help page.</p>
<div class="image">
<img src="../MinitaurLeg.PNG"  alt="Minitaur leg kinematics definitions" title="Minitaur leg kinematics definitions"/>
</div>
<p>The end-effector coordinates (first argument to MinitaurLeg::setOpenLoop(), MinitaurLeg::setGain(), and MinitaurLeg::setPosition()) are <code>EXTENSION</code> and <code>ANGLE</code>. Assuming the inidividual motor zeros are set when the upper links are pointing vertically up, and the motor directions are set so the positions increase as the motors sweep down (this is the default of Minitaur),</p><ul>
<li>The <code>ANGLE</code> coordinate always refers to <em>α - π</em> in radians (where the front of the robot is to the right in the figure above). I.e., when the leg is vertically pointing down, <code>ANGLE</code> is 0, if it sweeps back, <code>ANGLE</code> is positive, etc.</li>
<li>When MinitaurLeg::useLengths is false (this is default), the <code>EXTENSION</code> coordinate either refers to <em>β</em> in radians from 0 (fully retracted) to <em>π</em> (fully extended)</li>
<li>When MinitaurLeg::useLengths is true, the <code>EXTENSION</code> coordinate refers to <em>r</em> in meters.</li>
</ul>
<h3>Usage</h3>
<p>To use a <a class="el" href="class_minitaur_leg.html">MinitaurLeg</a> in your code, follow the usage steps in the <a class="el" href="class_abstract_motor.html">AbstractMotor</a> help page. Additionally,</p><ol type="1">
<li>Set MinitaurLeg::useLengths to true if you would like to use the <em>r</em> coordinate instead of <em>β</em> for the leg extension</li>
<li>Set the upper link length MinitaurLeg::l1 (default is 0.1 m) and the lower link length MinitaurLeg::l2 (default is 0.2 m)</li>
<li>You can call MinitaurLeg::getSpeed() to get a body speed estimate if you supply the body pitch (leaning forward is assumed to be positive pitch).</li>
<li>To get proprioceptive torque estimates, you can still use Motor::getTorque() as long as Motor::setTorqueEstParams() has been called.</li>
</ol>
<h3>Example</h3>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;Motor.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;MinitaurLeg.h&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="comment">// Uncomment the lines corresponding to your board</span></div>
<div class="line"><span class="comment">// MBLC 0.5</span></div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">int</span> NMOT = 10;</div>
<div class="line"><span class="keyword">const</span> uint8_t outPin[] = {PE9, PE11, PE13, PE14, PA0, PD4, PD7, PD6, PB4, PB5};</div>
<div class="line"><span class="keyword">const</span> uint8_t inPin[] = {PD12, PD13, PD14, PD15, PC6, PC7, PC8, PC9, PE2, PE3};</div>
<div class="line"><span class="comment">// // Mainboard v1.1</span></div>
<div class="line"><span class="comment">// const int NMOT = 8;</span></div>
<div class="line"><span class="comment">// const uint8_t outPin[] = {PA0, PA11, PA2, PA3, PB0, PB8, PA14, PA1};</span></div>
<div class="line"><span class="comment">// const uint8_t inPin[] = {PA6, PB5, PB6, PB7, PB1, PB9, PA15, PA5};</span></div>
<div class="line"><span class="comment">// // Mainboard v2</span></div>
<div class="line"><span class="comment">// const int NMOT = 8;</span></div>
<div class="line"><span class="comment">// const uint8_t outPin[] = {PA3, PA2, PA0, PA1, PB0, PB1, PA6, PB5};</span></div>
<div class="line"><span class="comment">// const uint8_t inPin[] = {PB8, PB9, PB3, PA8, PA11, PA15, PB14, PB15};</span></div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">int</span> CONTROL_RATE = 1000;</div>
<div class="line">BlCon34 M[NMOT];</div>
<div class="line"><a class="code" href="class_minitaur_leg.html">MinitaurLeg</a> leg0(&amp;M[1], &amp;M[0]);</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> controlLoop() {</div>
<div class="line">  leg0.update();</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> setup() {</div>
<div class="line">  Serial1.begin(115200);</div>
<div class="line"></div>
<div class="line">  Motor::updateRate = CONTROL_RATE;</div>
<div class="line">  Motor::velSmooth = 0.9;</div>
<div class="line">  <span class="comment">// Uncomment this for MBLC</span></div>
<div class="line">  <span class="comment">// BlCon34::useEXTI = true;</span></div>
<div class="line"></div>
<div class="line">  <span class="comment">// Arguments are pwmPin, pulsePin, zero(rad), direction(+/- 1)</span></div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;NMOT; ++i)</div>
<div class="line">    M[i].init(outPin[i], inPin[i], 0, 1);</div>
<div class="line"></div>
<div class="line">  <a class="code" href="group___timebase.html#ga5bf1468dbfe70bf8a0a511df76075992">attachTimerInterrupt</a>(0, controlLoop, CONTROL_RATE);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> loop() {</div>
<div class="line">  leg0.enable(<span class="keyword">true</span>);</div>
<div class="line">  <span class="comment">// These commands are similar to Motor commands, except with an added first argument</span></div>
<div class="line">  leg0.setGain(ANGLE, 0.3);</div>
<div class="line">  leg0.setPosition(ANGLE, 0);</div>
<div class="line"></div>
<div class="line">  leg0.setOpenLoop(EXTENSION, 0.1);</div>
<div class="line">}</div>
</div><!-- fragment --> </div><hr/>The documentation for this class was generated from the following file:<ul>
<li>MinitaurLeg.md</li>
</ul>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.8-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Oct 20 2016 18:35:45 for Koduino by &#160;<a href="http://www.doxygen.org/index.html">
Doxygen
</a> 1.8.10
</small></address>
</body>
</html>
